<!DOCTYPE html>
<html lang="en">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <head>
            <meta charset="utf-8">
                <title>
                    Document
                </title>
            </meta>
        </head>
        <link href="iconfont.css" rel="stylesheet" type="text/css">
            <script src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.js">
            </script>
            <script src="js/jquery.js" type="text/javascript">
            </script>
            <style type="text/css">
                *{
                    margin: 0;
                    padding: 0;
                    list-style: none;
                    text-decoration: none;
                }
                body{
                    background-color: #f5f5f5;
                    height: 100%
                }
                button{
                    outline:none;
                }
            </style>
            <link href="css/mainActive.css" rel="stylesheet" type="text/css">
                <link href="css/addActive.css" rel="stylesheet" type="text/css">
                    <body>
                        <div id="content">
                            <div id="right">
                                <div id="right_top">
                                    <img id="logo" src="logo.png">
                                        <em>
                                            活动大咖
                                        </em>
                                        <p>
                                            <i class="icon iconfont icon-bangzhuzhongxin">
                                            </i>
                                            管理员登陆
                                        </p>
                                    </img>
                                </div>
                                <div id="right_doSth">
                                    <div id="color">
                                        <ul>
                                            <li id="blue">
                                            </li>
                                            <li>
                                                草稿->
                                            </li>
                                            <li id="red">
                                            </li>
                                            <li>
                                                正在进行->
                                            </li>
                                            <li id="green">
                                            </li>
                                            <li>
                                                已完成->
                                            </li>
                                            <li id="yellow">
                                            </li>
                                            <li>
                                                活动结束
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div id="right_main">
                                    <div :data-actionid="baseinfo.actionId" :data-actionstate="baseinfo.actionState" class="myDiv" v-for="baseinfo in info_list" v-on:click="showAllInfo">
                                        <i class="icon iconfont icon-shanchu" v-on:click="deleAction">
                                        </i>
                                        <span class="myDiv_spa">
                                            {{baseinfo.theme}}
                                        </span>
                                        <div class="dis">
                                            <p class="myDiv_p">
                                                报名时间:
                                                <em class="em">
                                                    {{baseinfo.startTime}}
                                                </em>
                                            </p>
                                            <p class="myDiv_p">
                                                活动时间:
                                                <em class="em">
                                                    {{baseinfo.signUpStartTime}}
                                                </em>
                                            </p>
                                            <p class="myDiv_p">
                                                报名人数:
                                                <em class="em">
                                                    {{baseinfo.num}}
                                                </em>
                                            </p>
                                        </div>
                                        <button class="btn1" v-on:click="changeInfo">
                                            <i class="icon iconfont icon-31qiandao">
                                            </i>
                                            编辑
                                        </button>
                                    </div>
                                    <div class="myDiv0">
                                        <div id="add" v-on:click="addItem">
                                            +
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="bottom">
                                天津理工大学@2018年9月
                            </div>
                            <div id="addAction" v-show="visible">
                                <div class="modal-header">
                                    <button id="close" v-on:click="closeItem">
                                        X
                                    </button>
                                    <h2 class="modal-title">
                                        添加新活动
                                    </h2>
                                </div>
                                <div class="addlist" id="addPersonModal">
                                    <div class="addList_group">
                                        <div class="group">
                                            <div class="group1">
                                                <div class="group1_left">
                                                    <label>
                                                        活动主题:*
                                                    </label>
                                                </div>
                                                <div class="group1_right">
                                                    <input class="form-control" maxlength="15" name="text" type="text">
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="group1">
                                                <div class="group1_left">
                                                    <label>
                                                        默认思政分:*
                                                    </label>
                                                </div>
                                                <div class="group1_right">
                                                    <input class="form-control" name="text" type="text">
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="group1">
                                                <div class="group1_left">
                                                    <label>
                                                        活动描述:*
                                                    </label>
                                                </div>
                                                <div class="group1_right">
                                                    <textarea class="textarea" maxlength="500">
                                                    </textarea>
                                                </div>
                                            </div>
                                            <div class="group1">
                                                <div class="group1_left">
                                                    <label>
                                                        注意事项:*
                                                    </label>
                                                </div>
                                                <div class="group1_right">
                                                    <input class="form-control" maxlength="100" name="text" type="text">
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="group2">
                                                <div class="group2_left">
                                                    <label>
                                                        发布时间:*
                                                    </label>
                                                </div>
                                                <div class="group2_right">
                                                    <input name="radio" type="radio" value="0">
                                                        <label>
                                                            手动立即发布
                                                        </label>
                                                        <input id="setdata" name="radio" type="radio" value="1">
                                                            <label>
                                                                系统定时发布
                                                            </label>
                                                            <input class="group2_inp" id="setdatactivity" name="text" type="text">
                                                            </input>
                                                        </input>
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="group3">
                                                <div class="group3_left">
                                                    <label>
                                                        报名开始时间:
                                                    </label>
                                                    <input class="form-control" name="text" type="text">
                                                    </input>
                                                </div>
                                                <div class="group3_right">
                                                    <label>
                                                        报名截止时间:
                                                    </label>
                                                    <input class="form-control" name="text" type="text">
                                                    </input>
                                                </div>
                                            </div>
                                            <div class="group3">
                                                <div class="group3_left">
                                                    <label>
                                                        活动开始时间:
                                                    </label>
                                                    <input class="form-control" name="text" type="text">
                                                    </input>
                                                </div>
                                                <div class="group3_right">
                                                    <label>
                                                        活动截止时间:
                                                    </label>
                                                    <input class="form-control" name="text" type="text">
                                                    </input>
                                                </div>
                                            </div>
                                            <form class="group4">
                                                <div class="group4_left">
                                                    <label>
                                                        活动举办地点:*
                                                    </label>
                                                </div>
                                                <div class="group4_right">
                                                    <input class="form-control" maxlength="20" name="text" type="text">
                                                    </input>
                                                </div>
                                                <br>
                                                    <div class="group4_left">
                                                        <label>
                                                            报名人数上限:*
                                                        </label>
                                                    </div>
                                                    <div class="group4_right">
                                                        <input class="form-control" name="text" type="text">
                                                        </input>
                                                    </div>
                                                    <br>
                                                        <div class="group5_left">
                                                            <label>
                                                                活动负责人:
                                                            </label>
                                                            <input class="form-control" name="text" type="text">
                                                            </input>
                                                        </div>
                                                        <div class="group5_right">
                                                            <label>
                                                                负责人联系方式:
                                                            </label>
                                                            <input class="form-control" name="text" type="text">
                                                            </input>
                                                        </div>
                                                    </br>
                                                </br>
                                            </form>
                                            <button id="addbtn">
                                                +
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <div class="center-block">
                                        <button class="btn btn_default" id="cancelAdd" type="button">
                                            取消
                                        </button>
                                        <button class="btn btn_success" id="addAct" type="button" v-on:click="addAct">
                                            保存
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div id="shade" v-show="visible">
                            </div>
                        </div>
                    </body>
                </link>
            </link>
        </link>
    </meta>
</html>
<script src="js/main.js" type="text/javascript">
</script>
<script type="text/javascript">
    new Vue({
                el: "#content",
                data: {
                    info_list: '',
                    visible:false,
                },
                methods:{
                    //页面加载查询所有活动
                    getData () {
                        let self=this;
                        $.ajax({
                            // async : true,   
                            type: "POST",
                            url: "http://192.168.3.153:8080/teacher/getAllActivity",
                            data:"",
                            dataType:'json',
                            // jsonp:'callback',    
                            // jsonpCallback:"successCallback",
                            success:function(data){
                                console.log(data.data)
                                self.info_list=data.data;
                            }, 
                            error:function(XMLHttpRequest, textStatus, errorThrown){ 
                                console.log(XMLHttpRequest.status)
                                console.log(XMLHttpRequest.readyState)
                                console.log(textStatus)
                            }       
                        }); 

                    },

                    addItem(){
                        let self=this;
                        self.visible=true;
                    },

                    closeItem() {
                        let self=this;
                        self.visible=false;
                        location.reload(); 
                    },
                    addAct(){
                        let self=this;
                        // ev.stopPropagation();
                        var action1 =[]
                        $("input[name='text']").each(function(){
                            action1.push($(this).val())
                        });
                        var checked = $('input[name="radio"]:checked').val();
                        var description = $(".textarea").val();
                        function Activity(theme,score,description,tips,releaseState,releaseTime,signUpStartTime,signUpEndTime,starTime,endTime,fields){
                            this.theme = action1[0];
                            this.score = action1[1];
                            this.description = description;
                            this.tips = action1[2];
                            this.releaseState = releaseState;
                            this.releaseTime = action1[3];
                            this.signUpStartTime = action1[4];
                            this.signUpEndTime = action1[5];
                            this.starTime = action1[6];
                            this.endTime = action1[7];
                        }
                        var activity = new Activity();
                            activity.description = description;
                            activity.releaseState = checked;

                        var aaa = $(".group4 input");
                        console.log(aaa.length)
                        switch(aaa.length)
                            {
                                case 4:
                                    var fields111 ={
                                        f_info:aaa[0].value,
                                        signUpNumLimit:aaa[1].value,
                                        t_name:aaa[2].value,
                                        t_tel:aaa[3].value
                                    };
                                    // activity.fields = {
                                    //     fields1:fields111,
                                    // }
                                    break;
                                case 8:
                                    var fields111 ={
                                        f_info:aaa[0].value,
                                        signUpNumLimit:aaa[1].value,
                                        t_name:aaa[2].value,
                                        t_tel:aaa[3].value
                                    };
                                    var fields222 ={
                                        f_info:aaa[4].value,
                                        signUpNumLimit:aaa[5].value,
                                        t_name:aaa[6].value,
                                        t_tel:aaa[7].value
                                    };
                                    // activity.fields = {
                                    //     fields1:fields111,
                                    //     fields2:fields222,
                                    // }
                                    break;
                                case 12:
                                    var fields111 ={
                                        f_info:aaa[0].value,
                                        signUpNumLimit:aaa[1].value,
                                        t_name:aaa[2].value,
                                        t_tel:aaa[3].value
                                    };
                                    var fields222 ={
                                        f_info:aaa[4].value,
                                        signUpNumLimit:aaa[5].value,
                                        t_name:aaa[6].value,
                                        t_tel:aaa[7].value
                                    };
                                    var fields333 ={
                                        f_info:aaa[8].value,
                                        signUpNumLimit:aaa[9].value,
                                        t_name:aaa[10].value,
                                        t_tel:aaa[11].value
                                    };
                                    // activity.fields = {
                                    //     fields1:fields111,
                                    //     fields2:fields222,
                                    //     fields3:fields333
                                    // }
                                    break;
                            }
                        console.log(activity)
                        $.ajax({
                            type: "POST",
                            dataType: "json",
                            url: "http://192.168.3.153:8080/teacher/addActivity",
                            contentType : "application/x-www-form-urlencoded",
                            data : {activity},
                            success: function(data){
                                alert("success")
                            },
                            error:function(XMLHttpRequest, textStatus, errorThrown){ 
                                console.log(XMLHttpRequest.status)
                                console.log(XMLHttpRequest.readyState)
                                console.log(textStatus)
                            }     
                         });

                        alert("保存成功")
                    },

                    showAllInfo(){
                        let self=this;
                        self.visible=true;
                            $.ajax({
                                type: "GET",
                                url: "xxxAction?actionId",
                                // data:"actionId="+actionId    ,
                                dataType: "json",
                                success: function(data){
                                            //查询出所有的数据
                                            //将遮照层的节点删除，用es6模版来动态生成。    
                                            //生成一个人员名单按钮
                                        }
                            });
                            alert("详情")
                    },

                    changeInfo(ev){
                        let self=this;
                        self.visible=true;
                        ev.stopPropagation();
                            $.ajax({
                                type: "GET",
                                url: "xxxAction?actionId",
                                // data:"actionId="+actionId    ,
                                dataType: "json",
                                success: function(data){
                                            //根据id查数据，查完添加到输入框
                                }
                            });
                    },

                    deleAction(ev){
                        alert("del")
                        let self=this;
                        ev.stopPropagation();
                        // var actionId = this.parentNode.getAttribute('data-actionid');
                        // console.log(actionId)
                        $.ajax({
                                type: "GET",
                                url: "xxxAction?actionId",
                                // data:"actionId="+actionId    ,
                                dataType: "json",
                                success: function(data){
                                            //根据id查数据，查完添加到输入框
                                }
                        });
                        location.reload(); 
                    },
                },
                created:function() {
                    this.getData();
                    console.log("success");
                },
                mounted:function() {
                
                }
            
                
            });

window.onload = ()=>{

}
    // //----增加活动----
    // var showShade = document.getElementsByClassName("myDiv0");
    // var closeShade = document.getElementById("close");
    // for (let i = 0; i < showShade.length; i++) {
    //  showShade[i].onclick = () =>{
    //      alert("------------")
    //      showShade()
    //  }
    // }   
    //  closeShade.onclick =()=>{
    //      closeShade()
    //  }
    // var showShade = function () {
    //  document.getElementById("shade").style.display = 'block';
    //  document.getElementById("addAction").style.display = 'block';
    // };
    // var closeShade = function () {
    //  document.getElementById("shade").style.display = 'none';
    //  document.getElementById("addAction").style.display = 'none';
    //  location.reload(); 
    // };

    //增加活动---增加分会场
    document.getElementById("addbtn").onclick = () =>{
        var activity = document.getElementsByClassName("group4");
        var a2 = activity[0].cloneNode(true);
        a2.reset();
        var a3 = document.getElementsByClassName("group");
        if (activity.length >=3) {
            alert("bukeyi")
            return false;
        }
        a3[0].appendChild(a2);
    }
    //增加活动---向后台发送数据
    // $("#addAct").click(function(ev){
        
    // });

    //-----删除活动------
    // $('.icon-shanchu').click(function(ev){
    //     ev.stopPropagation();
    //     console.log(this)
    //     var actionId = this.parentNode.getAttribute('data-actionid');
    //         $.ajax({
    //             type: "GET",
    //             url: "xxxAction?actionId",
    //             // data:"actionId="+actionId    ,
    //             dataType: "json",
    //             success: function(data){
                            
    //                     }
    //         });
    //     console.log(actionId)   
    // });

    //-----单选按钮-----
    var setD = document.getElementById("setdata");
        setD.onclick = ()=>{
            document.getElementById("setdatactivity").style.display = 'block';
        }
    
    //-----查看详情-----
    // $(".myDiv").click(function(){
    //     console.log(this)
    //     showShade();//遮照层
    //     let actionId = this.getAttribute('data-actionid');
    //         $.ajax({
    //             type: "GET",
    //             url: "xxxAction?actionId",
    //             // data:"actionId="+actionId    ,
    //             dataType: "json",
    //             success: function(data){
    //                         //查询出所有的数据
    //                         //将遮照层的节点删除，用es6模版来动态生成。    
    //                         //生成一个人员名单按钮
    //                     }
    //         });
    //     alert("详情")
    // });

    //-----编辑-----
    // $(".btn1").click(function(ev){
    //     alert("编辑")
    //     ev.stopPropagation();
    //     showShade();
    //     $.ajax({
    //             type: "GET",
    //             url: "xxxAction?actionId",
    //             // data:"actionId="+actionId    ,
    //             dataType: "json",
    //             success: function(data){
    //                         //根据id查数据，查完添加到输入框
    //                     }
    //         });
    // })
</script>
